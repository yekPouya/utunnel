<h1 align="center" style="font-size: 2.5em; margin-bottom: 15px; color: #2c3e50;">🚀 UTunnel Manager - راهکار حرفه‌ای تونلینگ امن</h1>

<h3 align="center" style="font-size: 1.4em; background: linear-gradient(90deg, #ff4d4d, #f9cb28); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 25px; padding: 10px; border-radius: 5px; border-left: 4px solid #e74c3c; border-right: 4px solid #e74c3c;">
🔥 عملکرد بی‌نظیر حتی روی سرورهای خارج از کشور با محدودیت شدید 🔥
</h3>


<div align="center" style="margin-bottom: 30px;">
  <img src="https://img.shields.io/badge/Go-1.21+-blue?style=for-the-badge&logo=go" alt="نسخه Go">
  <img src="https://img.shields.io/badge/License-MIT-green?style=for-the-badge&logo=opensourceinitiative" alt="مجوز">
  <img src="https://img.shields.io/badge/Foreign_Servers-Supported-orange?style=for-the-badge&logo=serverless" alt="پشتیبانی از سرورهای خارج">
  
  <!-- دکمه‌های معماری‌های پشتیبانی شده -->
  <div style="margin-top: 15px;">
    <img src="https://img.shields.io/badge/x86_64-Supported-success?style=flat-square&logo=amd" alt="x86_64">
    <img src="https://img.shields.io/badge/ARM64-Supported-success?style=flat-square&logo=arm" alt="ARM64">
    <img src="https://img.shields.io/badge/RISC_V-Experimental-yellow?style=flat-square&logo=riscv" alt="RISC-V">
  </div>
</div>

[![English Version](https://img.shields.io/badge/README_English-FFA500?style=for-the-badge&logo=bookstack&logoColor=white)](./README-EN.md)





 🌐 معرفی جامع
 
یک راهکار حرفه‌ای برای ایجاد تونل‌های امن و پرسرعت معکوس بین سرورهاست که با بهره‌گیری از آخرین فناوری‌های شبکه، امکان انتقال ترافیک با کمترین تاخیر را فراهم می‌کند. این سیستم به‌طور خاص برای محیط‌های حساس به تاخیر و نیازمند امنیت بالا طراحی شده است.

### 🔬 مشخصات فنی کلیدی

- **تاخیر**: <10ms در شبکه‌های بهینه‌شده
- 
- **پهنای باند**: پشتیبانی از Jumbo Frames (9000 بایت)
- 
- **امنیت**: TLS 1.3 با رمزنگاری AES-256-GCM
- 
- **بهینه‌سازی**: کاهش 40% مصرف CPU با الگوریتم‌های اختصاصی




## 🌟 پروتکل‌های کامل و کاربردهای آنها

| پروتکل       | 📌 ویژگی‌های کلیدی                        | 🏆 بهترین موارد استفاده      | 🔧 پارامترهای بهینه |
|--------------|------------------------------------------|-----------------------------|-------------------|
| **🛰️ TCP**      | 🔗 اتصال پایدار و مطمئن<br>📦 تضمین تحویل بسته‌ها<br>⚖️ کنترل جریان خودکار | 🖥️ انتقال فایل‌ها<br>📧 پروتکل‌های ایمیل<br>🌐 مرورگرهای وب | `window_size=256k`<br>`keepalive=60s` |
| **🌀 UDP**      | ⚡ سرعت بالا<br>🔄 ارتباط بدون اتصال<br>📡 مناسب برای داده‌های بلادرنگ | 🎮 بازی‌های آنلاین<br>📞 VoIP<br>📹 استریم ویدیو | `buffer=2MB`<br>`timeout=3s` |
| **🌐 WS**       | 🔄 ارتباط دوطرفه<br>🌍 مبتنی بر HTTP<br>🚀 مناسب برای وب‌سوکت‌ها | 💬 چت‌های بلادرنگ<br>📊 آپدیت‌های لحظه‌ای<br>🎮 بازی‌های مرورگری | `ping_interval=25s`<br>`max_size=1MB` |
| **🌉 TCPMux**   | 🔗 چندگانگی اتصالات<br>⚡ کاهش سربار<br>📦 بهینه برای داده‌های حجیم | 🖥️ انتقال داده‌های حجیم<br>🏢 ارتباطات سازمانی | `mux_con=8`<br>`timeout=30s` |
| **🕸️ WSMux**    | 🌐 ترکیب WebSocket + Muxing<br>🛡️ عبور از فایروال‌ها<br>🗜️ فشرده‌سازی | 💻 برنامه‌های وب پیشرفته<br>📱 ارتباطات موبایل | `compression=zlib`<br>`ping_interval=25s` |
| **🔐 WSS**      | 🔒 WS + SSL/TLS<br>🛡️ رمزنگاری end-to-end<br>📈 امنیت بالا | 🏦 تراکنش‌های مالی<br>🔐 لاگین‌های امن<br>🏥 داده‌های پزشکی | `tls_version=1.3`<br>`cert_check=strict` |
| **🔐 WSSMux**   | 🔒 WSMux + SSL/TLS<br>🛡️ امنیت end-to-end<br>📈 بهینه برای تراکنش‌ها | 🏦 سیستم‌های مالی<br> 🏥 ارتباطات پزشکی | `tls_version=1.3`<br>`cert_check=strict` |
| **🚄 UTCPmux**  | ⚡ بهینه‌سازی شده برای سرعت بالا<br>📡 Jumbo Frames<br>🌐 کاهش 40% CPU | 🖥️ مراکز داده<br>☁️ سرویس‌های ابری | `frame_size=9000`<br>`concurrency=16` |
| **🛡️ UWSmux**   | 🗜️ فشرده‌سازی هوشمند<br>⏱️ کاهش 30% تاخیر<br>🔄 بازیابی خودکار | 💼 ارتباطات سازمانی<br>🌍 سرویس‌های بین‌المللی | `compress_level=6`<br>`recovery_time=5s` |

## 📊 ماتریس انتخاب پروتکل - راهنمای جامع

این جدول به شما کمک می‌کند بر اساس نیازهای خود بهترین پروتکل را انتخاب کنید:

<div align="center">

| معیار        | توضیحات فنی                     | TCP  | TCPMux | UDP  | WS   | WSS  | WSMux | WSSMux | UTCPmux | UWSmux |
|--------------|----------------------------------|------|--------|------|------|------|-------|--------|---------|--------|
| **سرعت**     | میزان انتقال داده در ثانیه       | 🟢   | 🔵     | 🔵   | 🟢   | 🟡   | 🟢    | 🟡     | 🔵      | 🟢     |
| **امنیت**    | سطح رمزنگاری و حفاظت            | 🟡   | 🟡     | 🔴   | 🟡   | 🟢   | 🟡    | 🟢     | 🟢      | 🟢     |
| **پایداری**  | مقاومت در برابر قطع ارتباط     | 🟢   | 🟢     | 🔴   | 🟢   | 🟢   | 🟢    | 🟢     | 🔵      | 🟢     |
| **تاخیر**    | زمان پاسخگویی (میلی‌ثانیه)      | 🟡   | 🟡     | 🟢   | 🟡   | 🟡   | 🟡    | 🟡     | 🟢      | 🟢     |
| **بهینه‌سازی**| مصرف منابع سیستم               | 🟡   | 🟢     | 🟢   | 🟡   | 🟡   | 🟢    | 🟢     | 🟢      | 🟢     |

</div>

### 🧩 راهنمای انتخاب:
- **برای بازی‌های آنلاین**: UDP (تاخیر کم)
- **برای بانک‌داری**: WSSMux (امنیت بالا)
- **برای انتقال فایل‌های حجیم**: TCPMux (بهینه‌سازی منابع)
- **برای استریم ویدیو**: UTCPmux (پهنای باند بالا)
- **برای چت‌های سازمانی**: UWSmux (تعادل سرعت و امنیت)


### راهنما:
- 🟢 عالی
- 🔵 بسیار خوب
- 🟡 متوسط
- 🔴 پایه

### ✨ راهنمای انتخاب پروتکل:
1. **پایستگی**: 🛰️ TCP / 🌉 TCPMux
2. **سرعت**: 🌀 UDP 
3. **وب ساده**: 🌐 WS
4. **وب امن**: 🔐 WSS
5. **وب پیشرفته**: 🕸️ WSMux / 🔐 WSSMux
6. **بهینه‌سازی**: 🚄 UTCPmux (سرعت) / 🛡️ UWSmux (امنیت)

### ⚠️ نکات فنی:
- همیشه برای وب از نسخه‌های امن استفاده کنید
- تنظیمات `buffer` را با توجه به پهنای باند تنظیم نمایید
- برای برنامه‌های وب مدرن از WSMux استفاده کنید
- نسخه‌های **Mux** برای کاهش تاخیر و مصرف منابع مناسب‌اند

<div align="center"> <img src="https://github.com/user-attachments/assets/5a5792c8-b101-45fc-8843-6dd419fc8f33" alt="معماری سیستم" width="800"> <p><em>نمایی از معماری پیشرفته سیستم</em></p> </div>


⚙️ تنظیمات بهینه

✅ بهترین روش‌ها

برای ارتباطات وب: استفاده از UWSmux با تنظیمات پیش‌فرض

برای انتقال داده حجیم: UTCPmux با mux_version=2

تنظیمات امنیتی: فعال‌سازی TLS و استفاده از گواهی‌های معتبر

⚠️ نکات فنی مهم

همیشه از آخرین نسخه پروتکل استفاده کنید

برای تغییر نسخه، تمام پارامترهای مرتبط را بازتنظیم نمایید

از channel_size مناسب برای بار ترافیکی خود استفاده کنید

✅ همیشه از mux_version=2 استفاده کنید:

کاهش ۳۰-۵۰% نیاز به mux_con

بهبود ۲۰-۴۰% عملکرد کلی

مصرف منابع کمتر

⚠️ تذکر مهم: هنگام تغییر نسخه، حتما channel_size و connection_pool را نیز تنظیم مجدد کنید!

**توضیحات تکمیلی**

# **توضیحات پارامترهای MUX در UTunnel**  

## **📌 مقدمه**  
در UTunnel، از **MUX (Multiplexing)** برای انتقال چندین جریان داده روی یک اتصال واحد استفاده می‌شود. این کار باعث کاهش سربار (Overhead) و بهبود کارایی در تونل‌های شبکه می‌شود.  
برای تنظیم دقیق عملکرد MUX، پارامترهای زیر در فایل کانفیگ قابل تغییر هستند. در این بخش، هر پارامتر را به طور کامل توضیح می‌دهیم و تأثیر افزایش یا کاهش مقادیر آن را بررسی می‌کنیم.  

---

## **🔹 پارامترهای MUX و تأثیر آنها**  

### **1. `mux_framesize = 32768`**  
📌 **توضیحات**:  
این پارامتر **اندازه هر فریم داده** در پروتکل MUX را تعیین می‌کند. مقدار پیش‌فرض **32 کیلوبایت (32768 بایت)** است.  

✅ **تأثیر افزایش مقدار (مثلاً `65536`)**:
- **بهبود انتقال داده‌های حجیم** (مثل فایل‌های بزرگ).  
- **کاهش سربار** (چون داده‌ها به فریم‌های کمتری تقسیم می‌شوند).  
- **مناسب برای شبکه‌های پرسرعت**.  

❌ **تأثیر کاهش مقدار (مثلاً `16384`)**:
- **بهینه برای ترافیک سبک** (مثل چت یا دستورات سریع).  
- **افزایش سربار** (تعداد فریم‌های بیشتر برای داده‌های بزرگ).  
- **ممکن است در انتقال فایل‌های حجیم کارایی کمتری داشته باشد**.  

---

### **2. `mux_recievebuffer = 4194304`**  
📌 **توضیحات**:  
این پارامتر **اندازه بافر دریافت کلی** برای تمام جریان‌های MUX را تنظیم می‌کند. مقدار پیش‌فرض **4 مگابایت (4194304 بایت)** است.  

✅ **تأثیر افزایش مقدار (مثلاً `8388608`)**:
- **بهبود عملکرد در شبکه‌های با تاخیر بالا** (مثل اینترنت ماهواره‌ای).  
- **جلوگیری از از دست رفتن داده در ترافیک سنگین**.  
- **مناسب برای سرورهای پرترافیک**.  

❌ **تأثیر کاهش مقدار (مثلاً `2097152`)**:
- **کاهش مصرف حافظه** (مناسب برای دستگاه‌های ضعیف).  
- **ممکن است در ترافیک سنگین باعث از دست رفتن داده شود**.  

---

### **3. `mux_streambuffer = 65536`**  
📌 **توضیحات**:  
این پارامتر **اندازه بافر برای هر جریان (Stream) جداگانه** در MUX را تعیین می‌کند. مقدار پیش‌فرض **64 کیلوبایت (65536 بایت)** است.  

✅ **تأثیر افزایش مقدار (مثلاً `131072`)**:
- **بهبود انتقال داده برای جریان‌های حجیم** (مثل استریم ویدیو).  
- **کاهش تاخیر در پردازش داده‌های بزرگ**.  

❌ **تأثیر کاهش مقدار (مثلاً `32768`)**:
- **صرفه‌جویی در حافظه** (مناسب برای دستگاه‌های کم‌قدرت).  
- **ممکن است در انتقال داده‌های حجیم کارایی کمتری داشته باشد**.  

---

## **🎯 تنظیمات پیشنهادی بر اساس نیاز**  

| **نوع استفاده**               | **پیشنهاد تنظیمات**                          | **توضیحات**                                  |
|-------------------------------|---------------------------------------------|---------------------------------------------|
| **ترافیک سبک (چت، دستورات)**  | `mux_framesize=16384`, `mux_streambuffer=32768` | کاهش سربار برای ارتباطات سریع.              |
| **ترافیک سنگین (فایل، ویدیو)**| `mux_framesize=65536`, `mux_recievebuffer=8388608` | بهبود انتقال داده‌های حجیم.                |
| **شبکه‌های با تاخیر بالا**    | `mux_recievebuffer=8388608`                 | جلوگیری از از دست رفتن داده در شبکه‌های ضعیف. |
| **دستگاه‌های کم‌مصرف (RPi)**  | `mux_streambuffer=32768`, `mux_recievebuffer=2097152` | کاهش مصرف حافظه.                           |

---

برای مدیریت **50 تا 500 کاربر همزمان** در UTunnel، باید تنظیمات را بر اساس **مقیاس‌پذیری، مصرف منابع و پایداری** بهینه کنید. در جدول زیر، مقادیر پیشنهادی برای هر سطح از کاربران آورده شده است:

---

### **📊 جدول تنظیمات بهینه UTunnel برای کاربران همزمان مختلف**

| پارامتر               | 50 کاربر          | 100 کاربر         | 200 کاربر         | 300 کاربر         | 400 کاربر         | 500 کاربر         | توضیحات                     |
|-----------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|-----------------------------|
| **`transport`**       | `wssmux`          | `wssmux`          | `wssmux`          | `wssmux`          | `wssmux`          | `wssmux`          | پروتکل امن و پایدار         |
| **`mux_con`**         | `8`               | `16`              | `24`              | `32`              | `40`              | `48`              | تعداد اتصالات همزمان         |
| **`mux_framesize`**   | `16384` (16 KiB)  | `32768` (32 KiB)  | `32768` (32 KiB)  | `65536` (64 KiB)  | `65536` (64 KiB)  | `65536` (64 KiB)  | اندازه هر فریم داده          |
| **`mux_recievebuffer`**| `4194304` (4 MiB)| `8388608` (8 MiB) | `16777216` (16 MiB)| `25165824` (24 MiB)| `33554432` (32 MiB)| `50331648` (48 MiB)| بافر دریافت کلی              |
| **`mux_streambuffer`**| `32768` (32 KiB)  | `65536` (64 KiB)  | `65536` (64 KiB)  | `131072` (128 KiB)| `131072` (128 KiB)| `262144` (256 KiB)| بافر هر جریان                |
| **`connection_pool`** | `8`               | `12`              | `16`              | `20`              | `24`              | `32`              | تعداد اتصالات رزرو شده       |
| **`heartbeat`**       | `40` ثانیه        | `30` ثانیه        | `25` ثانیه        | `20` ثانیه        | `15` ثانیه        | `10` ثانیه        | فاصله بررسی اتصال           |
| **`channel_size`**    | `2048`            | `4096`            | `8192`            | `12288`           | `16384`           | `24576`           | ظرفیت کانال ارتباطی         |
| **`log_level`**       | `info`            | `warn`            | `warn`            | `error`           | `error`           | `error`           | سطح جزئیات لاگ‌ها            |

---

🎯 نتیجه‌گیری

50-200 کاربر: تنظیمات معمولی با افزایش جزئی بافرها.

200-500 کاربر: افزایش چشمگیر mux_recievebuffer و mux_streambuffer + کاهش heartbeat.

500+ کاربر: نیاز به کلاسترینگ یا سرورهای قدرتمندتر.

این مقادیر بر اساس بهینه‌سازی توازن بین منابع و کارایی پیشنهاد شده‌اند. برای محیط‌های خاص ممکن است نیاز به تنظیم دقیق‌تر باشد.




### **📌 نکات نهایی**
✅ **برای 50-200 کاربر**:  
- تنظیمات پیش‌فرض + افزایش `mux_con` و `channel_size` کافی است.  

✅ **برای 200-500 کاربر**:  
- **افزایش `mux_recievebuffer` و `mux_streambuffer`** برای جلوگیری از overload.  
- **کاهش `heartbeat`** برای تشخیص سریع‌تر قطعی‌ها.  
- **استفاده از Load Balancer** اگر سرور تک‌هاست است.  

با این تنظیمات، سرور شما قادر به مدیریت **500 کاربر همزمان به صورت پایدار** خواهد بود! 🚀


## **📢 نکته نهایی**  
این پارامترها باید بر اساس **نیاز شبکه و سخت‌افزار** تنظیم شوند.  
🔹 **اگر سرعت شبکه بالا است**: افزایش `mux_framesize` و `mux_recievebuffer` مفید است.  
🔹 **اگر حافظه محدود است**: کاهش `mux_streambuffer` و `mux_recievebuffer` توصیه می‌شود.  
🔹 **برای تست**: همیشه پس از تغییر مقادیر، عملکرد را بررسی کنید!  

با تنظیم بهینه این پارامترها، می‌توانید **حداکثر کارایی** از UTunnel را دریافت کنید! 🚀



🖼️ گالری تصاویر 

<div align="center"> <table> <tr> <td><img src="https://github.com/user-attachments/assets/09f19faa-d157-40d6-a7d1-0e4d31607297" width="400" alt="نمونه 1"></td> <td><img src="https://github.com/user-attachments/assets/9ae26d5a-b008-4543-8156-1f8afbcad86f" width="400" alt="نمونه 2"></td> <td><img src="https://github.com/user-attachments/assets/395ff89e-bef0-4cbc-bec5-70e501171761" width="400" alt="نمونه 4"></td> </tr> </table> </div>
📝 راهنمای جامع حالت‌های عملیاتی

🔵 حالت سرور (اجرا روی سرور ایران)

نام سرویس: هر نامی با حروف و اعداد انگلیسی (منحصر به فرد در هر سرور)

توکن: باید مطابق با مقدار سرور خارج باشد

پورت تانل: باید با مقدار سرور خارج یکسان باشد

mux_con: تعداد کانکشن‌های مولتی‌پلکس (پیش‌فرض: 8)

🟢 حالت کلاینت (اجرا روی سرور خارج)

نیاز به آیپی سرور ایران و پورت تانل (مطابق با تنظیمات سرور)

🟡 سایر حالت‌ها:

وضعیت: نمایش وضعیت تانل‌ها

ریستارت: راه‌اندازی مجدد یک یا همه تانل‌ها

توقف: متوقف کردن یک یا همه سرویس‌های تانل

حذف: حذف یک یا همه تانل‌ها

تایمر: تنظیم ریستارت خودکار (1 تا 23 ساعت)

🔧 نمونه‌های تنظیمات پورت
```
443-600                  # گوش دادن به پورت‌های 443-600 و فوروارد به همان پورت‌ها در مقصد
443-600:5201             # گوش دادن به 443-600 و فوروارد به پورت 5201
443-600=1.1.1.1:5201     # گوش دادن به 443-600 و فوروارد به پورت 5201 روی IP 1.1.1.1
443                      # گوش دادن به پورت 443 و فوروارد به پورت 443 مقصد
4000=5000                # گوش دادن به 4000 و فوروارد به 5000
127.0.0.2:443=5201       # گوش دادن به 443 روی IP 127.0.0.2 و فوروارد به 5201
443=1.1.1.1:5201         # گوش دادن به 443 و فوروارد به 5201 روی 1.1.1.1
127.0.0.2:443=1.1.1.1:5201  # گوش دادن به 443 روی 127.0.0.2 و فوروارد به 5201 روی 1.1.1.1
```
💻 راهنمای نصب و اجرا

برای نصب این دستور را اجرا کنید

```
bash <(curl -s https://raw.githubusercontent.com/yekPouya/utunnel/refs/heads/main/install_utunnel.sh --ipv4)
```

🤖 نصب ربات تلگرام مونیتورینگ

```
bash <(curl -s https://raw.githubusercontent.com/yekPouya/utunnel/refs/heads/main/MonitorBotinstall.sh --ipv4)
```
پس از اجرا:

گزینه نصب را انتخاب کنید

توکن ربات و چت آی دی خود را وارد نمایید

زمان بررسی تانل‌ها را بر اساس ثانیه تنظیم کنید

## 💰 حمایت مالی

ما از حمایت شما برای توسعه و بهبود مستمر پروژه قدردانی می‌کنیم:

<div align="center">

| شبکه         | نوع ارز       | آدرس کیف پول                              | آیکون       |
|--------------|--------------|------------------------------------------|------------|
| **Tron**     | TRX (TRC20)  | `TMXRpCsbz8PKzqN4koXiErawdLXzeinWbQ`     | <img src="https://cryptologos.cc/logos/tron-trx-logo.png" width="20"> |
| **Ethereum** | USDT (ERC20) | `0xD4cEBA0cFf6769Fb9EFE4606bE59C363Ff85BF76` | <img src="https://cryptologos.cc/logos/tether-usdt-logo.png" width="20"> |

</div>

<div align="center" style="margin-top: 20px;">
  <p>🙏 از اعتماد و حمایت ارزشمند شما سپاسگزاریم</p>
  <p>هر میزان کمک مالی، انگیزه‌ای برای توسعه و ارتقای پروژه خواهد بود</p>
</div>



<div align="center"> <table> <tr> <td><img src="https://github.com/user-attachments/assets/29063460-b7f5-4e59-88df-bbe4bb84c836" width="300"></td> <td><img src="https://github.com/user-attachments/assets/c2f33b82-46ad-46c8-b514-2d017532e5f4" width="300"></td> </tr> <tr> <td><img src="https://github.com/user-attachments/assets/e7fbaa6e-2d6a-48c8-9696-0cc8ab528a14" width="300"></td> <td><img src="https://github.com/user-attachments/assets/59322989-d5ae-472f-a491-34104ec85b74" width="300"></td> </tr> </table> </div>
